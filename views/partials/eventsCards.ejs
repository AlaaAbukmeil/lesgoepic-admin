<div class="title">
  <h1>Upcoming Events</h1>
</div>
<div class="events row">
  <form class="" action = "/addNewEvent" method="get">
    <button type="submit" class="btn addNewEventButton">Add new event!</button>
  </form>

  <% let length = eventsActive.length;%>
  <h2 class="sub-title">Active Events</h2>
  <% for(let i=0; i< length; i++){ %>
  <div class="col-lg-4 col-md-6 col-10 eventCard">
    <form name="eventsActive">
      <div class="card">
        <img src="<%=eventsActive[i].image%>" class="card-img-top" alt="...">
        <div class="card-body">
          <% if (eventsActive[i].cost != "-1") { %>
          <h4 class="date">ğŸ“… <%=eventsActive[i].date%></h4>
          <h4 class="name">ğŸ“ <%=eventsActive[i].name%></h4>
          <% } %>
          <% if (eventsActive[i].cost == "-1") { %>
          <h4 class="name"><%=eventsActive[i].name%></h4>
          <div class="buttons">
            <button type="button" onclick="confirmDeleteActiveEvent(&quot;<%=eventsActive[i].name%>&quot;, '/deleteEvent:<%=eventsActive[i]['_id']%>')" class="btn btn-danger deleteButton">DELETE</button>
            <button type="submit" formaction="/editEvent:<%=eventsActive[i]['_id']%>" formmethod="get" class="btn signupButton">Edit</button>
          </div>
          <% } else if (eventsActive[i].cost == "0") { %>
          <h4 class="price">ğŸ’¸ FREE</h4>
          <div class="buttons">
            <button type="button" onclick="confirmDeleteActiveEvent(&quot;<%=eventsActive[i].name%>&quot;, '/deleteEvent:<%=eventsActive[i]['_id']%>')" class="btn btn-danger deleteButton">DELETE</button>
            <button type="submit" formaction="/editEvent:<%=eventsActive[i]['_id']%>" formmethod="get" class="btn signupButton">Edit</button>
          </div>
          <% } else {%>
          <h4 class="price">ğŸ’¸ <%=eventsActive[i].cost%> HKD</h4>
          <h4 class="name">Order: <%=eventsActive[i].order%></h4>
          <div class="buttons">
            <button type="button" onclick="confirmDeleteActiveEvent(&quot;<%=eventsActive[i].name%>&quot;, '/deleteEvent:<%=eventsActive[i]['_id']%>')" class="btn btn-danger deleteButton">DELETE</button>
            <button type="submit" formaction="/editEvent:<%=eventsActive[i]['_id']%>" formmethod="get" class="btn signupButton">Edit</button>
          </div>
          <% } %>

        </div>
      </div>
    </form>
  </div>
  <%  }%>

  <% length = eventsPassed.length;%>
  <h2 class="sub-title">Disabled Events</h2>
  <% for(let j=0; j< length; j++){ %>
  <div class="col-lg-4 col-md-6 col-10 eventCard">
    <form  name="eventsPassed">
      <div class="card">
        <img src="<%=eventsPassed[j].image%>" class="card-img-top" alt="...">
        <div class="card-body">
          <% if (eventsPassed[j].cost != "-1") { %>
          <h4 class="date">ğŸ“… <%=eventsPassed[j].date%></h4>
          <h4 class="name">ğŸ“ <%=eventsPassed[j].name%></h4>
          <% } %>
          <% if (eventsPassed[j].cost == "-1") { %>
          <h4 class="name"><%=eventsPassed[j].name%></h4>
          <div class="buttons">
            <button type="button" onclick="confirmDeleteActiveEvent(&quot;<%=eventsPassed[j].name%>&quot;, '/deleteEvent:<%=eventsPassed[j]['_id']%>')" class="btn btn-danger deleteButton">DELETE</button>
            <button type="submit" formaction="/editEvent:<%=eventsPassed[j]['_id']%>" formmethod="get" class="btn signupButton">Edit</button>
          </div>
          <h4 class="name"></h4>
          <% } else if (eventsPassed[j].cost == "0") { %>
          <h4 class="price">ğŸ’¸ FREE</h4>
          <h4 class="name">Order: <%=eventsPassed[j].order%></h4>
          <div class="buttons">
            <button type="button" onclick="confirmDeleteActiveEvent(&quot;<%=eventsPassed[j].name%>&quot;, '/deleteEvent:<%=eventsPassed[j]['_id']%>')" class="btn btn-danger deleteButton">DELETE</button>
            <button type="submit" formaction="/editEvent:<%=eventsPassed[j]['_id']%>" formmethod="get" class="btn signupButton">Edit</button>
          </div>
          <% } else {%>
          <h4 class="price">ğŸ’¸ <%=eventsPassed[j].cost%> HKD</h4>
          <h4 class="name">Order: <%=eventsPassed[j].order%></h4>
          <div class="buttons">
            <button type="button" onclick="confirmDeleteActiveEvent(&quot;<%=eventsPassed[j].name%>&quot;, '/deleteEvent:<%=eventsPassed[j]['_id']%>')" class="btn btn-danger deleteButton">DELETE</button>
            <button type="submit" formaction="/editEvent:<%=eventsPassed[j]['_id']%>" formmethod="get" class="btn signupButton">Edit</button>
          </div>
          <% } %>

        </div>
      </div>
    </form>
  </div>
  <%  }%>

</div>

<script type="text/javascript">
  function confirmDeleteActiveEvent(eventName, formaction) {
    let form = document.forms["eventsActive"]
    var result = confirm("Are you sure you want to delete " + eventName + "?");
    if (result) {

      form.setAttribute("method", "post");
      form.setAttribute("action", formaction);
      form.submit()
    }
  }

  function confirmDeletePassedEvent(eventName, formaction) {
    let form = document.forms["eventsPassed"]

    console.log(eventName, document.forms["eventsPassed"])
    var result = confirm("Are you sure you want to delete " + eventName + "?");
    if (result) {
      form.setAttribute("method", "post");
      form.setAttribute("action", formaction);
      form.submit()
    }
  }
</script>
